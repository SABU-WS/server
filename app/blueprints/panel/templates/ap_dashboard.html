{% extends 'admin_base.html' %}
{% set title='Dashboard' %}
{% block contents %}
	 <!-- DASHBOARD -->
     <div class="p-4 sm:ml-64">
        <div class="p-8 mt-16">
            <div class="grid grid-cols-3 gap-6 mb-6"> <!-- grid 4 si alert enable -->
                <div class="flex bg-white dark:bg-gray-700 rounded-2xl shadow-md h-20">
                    <div class="flex items-center w-full">
                        <div class="flex-col ml-4">
                            <h1 class="text-xs xl:text-base text-gray-500 font-semibold dark:text-gray-300">Online endpoints</h1>
                            <h1 class="text-lg xl:text-3xl font-bold text-black dark:text-white">{{ number_endpoint_on }}/{{ number_endpoint_tot }}</h1>
                        </div>
                        <div class="m-auto mr-6">
                            <h1 class="bg-gradient-to-t from-lightblue to-darkblue px-4 py-4 rounded-2xl"><svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 576 512"><path fill="#ffffff" d="M64 0C28.7 0 0 28.7 0 64V352c0 35.3 28.7 64 64 64H240l-10.7 32H160c-17.7 0-32 14.3-32 32s14.3 32 32 32H416c17.7 0 32-14.3 32-32s-14.3-32-32-32H346.7L336 416H512c35.3 0 64-28.7 64-64V64c0-35.3-28.7-64-64-64H64zM512 64V288H64V64H512z"/></svg></h1>
                        </div>
                    </div>
                </div>
                <div class="flex justify-center bg-white dark:bg-gray-700 rounded-2xl shadow-md">
                    <div class="flex items-center w-full">
                        <div class="flex-col ml-4">
                            <h1 class="text-xs xl:text-base text-gray-500 font-semibold dark:text-gray-300">Number of scans</h1>
                            <h1 class="text-lg xl:text-3xl font-bold text-black dark:text-white">{{ all_scan_7day }}</h1>
                        </div>
                        <div class="m-auto mr-6">
                            <h1 class="bg-gradient-to-t from-lightblue to-darkblue px-4 py-4 rounded-2xl"><svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 512 512"><path fill="#ffffff" d="M216 186.7c-23.9 13.8-40 39.7-40 69.3L32 256C14.3 256-.2 241.6 2 224.1C10.7 154 47.8 92.7 101.3 52c14.1-10.7 33.8-5.3 42.7 10l72 124.7zM256 336c14.6 0 28.2-3.9 40-10.7l72 124.8c8.8 15.3 3.7 35.1-12.6 41.9c-30.6 12.9-64.2 20-99.4 20s-68.9-7.1-99.4-20c-16.3-6.9-21.4-26.6-12.6-41.9l72-124.8c11.8 6.8 25.4 10.7 40 10.7zm224-80l-144 0c0-29.6-16.1-55.5-40-69.3L368 62c8.8-15.3 28.6-20.7 42.7-10c53.6 40.7 90.6 102 99.4 172.1c2.2 17.5-12.4 31.9-30 31.9zM256 208a48 48 0 1 1 0 96 48 48 0 1 1 0-96z"/></svg></h1>
                        </div>
                    </div>
                </div>
                <div class="flex justify-center bg-white dark:bg-gray-700 rounded-2xl shadow-md">
                    <div class="flex items-center w-full">
                        <div class="flex-col ml-4">
                            <h1 class="text-xs xl:text-base text-gray-500 font-semibold dark:text-gray-300">Number of viruses detected</h1>
                            <h1 class="text-lg xl:text-3xl font-bold text-black dark:text-white">{{ all_virus_7day }}</h1>
                        </div>
                        <div class="m-auto mr-6">
                            <h1 class="bg-gradient-to-t from-lightblue to-darkblue px-4 py-4 rounded-2xl"><svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 512 512"><path fill="#ffffff" d="M288 32c0-17.7-14.3-32-32-32s-32 14.3-32 32V43.5c0 49.9-60.3 74.9-95.6 39.6L120.2 75C107.7 62.5 87.5 62.5 75 75s-12.5 32.8 0 45.3l8.2 8.2C118.4 163.7 93.4 224 43.5 224H32c-17.7 0-32 14.3-32 32s14.3 32 32 32H43.5c49.9 0 74.9 60.3 39.6 95.6L75 391.8c-12.5 12.5-12.5 32.8 0 45.3s32.8 12.5 45.3 0l8.2-8.2c35.3-35.3 95.6-10.3 95.6 39.6V480c0 17.7 14.3 32 32 32s32-14.3 32-32V468.5c0-49.9 60.3-74.9 95.6-39.6l8.2 8.2c12.5 12.5 32.8 12.5 45.3 0s12.5-32.8 0-45.3l-8.2-8.2c-35.3-35.3-10.3-95.6 39.6-95.6H480c17.7 0 32-14.3 32-32s-14.3-32-32-32H468.5c-49.9 0-74.9-60.3-39.6-95.6l8.2-8.2c12.5-12.5 12.5-32.8 0-45.3s-32.8-12.5-45.3 0l-8.2 8.2C348.3 118.4 288 93.4 288 43.5V32zM176 224a48 48 0 1 1 96 0 48 48 0 1 1 -96 0zm128 56a24 24 0 1 1 0 48 24 24 0 1 1 0-48z"/></svg></h1>
                        </div>
                    </div>
                </div>
                <!-- <div class="flex justify-center bg-white dark:bg-gray-700 rounded-2xl shadow-md">
                    <div class="flex items-center w-full">
                        <div class="flex-col ml-4">
                            <h1 class="text-xs xl:text-base text-gray-500 font-semibold dark:text-gray-300">Number of alerts</h1>
                            <h1 class="text-lg xl:text-3xl font-bold text-black dark:text-white">3</h1>
                        </div>
                        <div class="m-auto mr-6">
                            <h1 class="bg-gradient-to-t from-lightblue to-darkblue px-4 py-4 rounded-2xl"><svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 448 512"><path fill="#ffffff" d="M224 0c-17.7 0-32 14.3-32 32V51.2C119 66 64 130.6 64 208v18.8c0 47-17.3 92.4-48.5 127.6l-7.4 8.3c-8.4 9.4-10.4 22.9-5.3 34.4S19.4 416 32 416H416c12.6 0 24-7.4 29.2-18.9s3.1-25-5.3-34.4l-7.4-8.3C401.3 319.2 384 273.9 384 226.8V208c0-77.4-55-142-128-156.8V32c0-17.7-14.3-32-32-32zm45.3 493.3c12-12 18.7-28.3 18.7-45.3H224 160c0 17 6.7 33.3 18.7 45.3s28.3 18.7 45.3 18.7s33.3-6.7 45.3-18.7z"/></svg></h1>
                        </div>
                    </div>
                </div> -->
            </div>

            <div class="grid grid-cols-2 gap-6 grid-rows-2">
                <div class="bg-white dark:bg-gray-700 rounded-2xl shadow-md p-4">
                    <h1 class="text-xs xl:text-base text-gray-500 font-semibold dark:text-gray-300 mb-2">Informations</h1>
                    <div class="overflow-x-auto rounded-lg">
                        <table class="w-full text-sm text-left text-gray-500 dark:text-gray-400">
                            <tbody>
                                <tr class="bg-white dark:bg-gray-700 border-b dark:border-gray-800">
                                    <th scope="row" class="px-6 py-4 font-medium text-gray-900 whitespace-nowrap dark:text-white">
                                        <h1 class="flex items-center"><svg class="mr-2 fill-gray-700 dark:fill-white" xmlns="http://www.w3.org/2000/svg" height="16" width="20" viewBox="0 0 512 512"><path d="M64 32C28.7 32 0 60.7 0 96v64c0 35.3 28.7 64 64 64H448c35.3 0 64-28.7 64-64V96c0-35.3-28.7-64-64-64H64zm280 72a24 24 0 1 1 0 48 24 24 0 1 1 0-48zm48 24a24 24 0 1 1 48 0 24 24 0 1 1 -48 0zM64 288c-35.3 0-64 28.7-64 64v64c0 35.3 28.7 64 64 64H448c35.3 0 64-28.7 64-64V352c0-35.3-28.7-64-64-64H64zm280 72a24 24 0 1 1 0 48 24 24 0 1 1 0-48zm56 24a24 24 0 1 1 48 0 24 24 0 1 1 -48 0z"/></svg><span class="font-bold">Hostname</span></h1>
                                    </th>
                                    <td class="px-6 py-4">
                                        {{ hostname }}
                                    </td>
                                </tr>
                                <tr class="bg-white dark:bg-gray-700 border-b dark:border-gray-800">
                                    <th scope="row" class="px-6 py-4 font-medium text-gray-900 whitespace-nowrap dark:text-white">
                                        <h1 class="flex items-center"><svg class="mr-2 fill-gray-700 dark:fill-white" xmlns="http://www.w3.org/2000/svg" height="16" width="20" viewBox="0 0 640 512"><path d="M256 64H384v64H256V64zM240 0c-26.5 0-48 21.5-48 48v96c0 26.5 21.5 48 48 48h48v32H32c-17.7 0-32 14.3-32 32s14.3 32 32 32h96v32H80c-26.5 0-48 21.5-48 48v96c0 26.5 21.5 48 48 48H240c26.5 0 48-21.5 48-48V368c0-26.5-21.5-48-48-48H192V288H448v32H400c-26.5 0-48 21.5-48 48v96c0 26.5 21.5 48 48 48H560c26.5 0 48-21.5 48-48V368c0-26.5-21.5-48-48-48H512V288h96c17.7 0 32-14.3 32-32s-14.3-32-32-32H352V192h48c26.5 0 48-21.5 48-48V48c0-26.5-21.5-48-48-48H240zM96 448V384H224v64H96zm320-64H544v64H416V384z"/></svg><span class="font-bold">IP address</span></h1>
                                    </th>
                                    <td class="px-6 py-4">
                                        {{ server_ip }}
                                    </td>
                                </tr>
                                <tr class="bg-white dark:bg-gray-700 border-b dark:border-gray-800">
                                    <th scope="row" class="px-6 py-4 font-medium text-gray-900 whitespace-nowrap dark:text-white">
                                        <h1 class="flex items-center"><svg class="mr-2 fill-gray-700 dark:fill-white" xmlns="http://www.w3.org/2000/svg" height="16" width="20" viewBox="0 0 512 512"><path d="M0 256a256 256 0 1 1 512 0A256 256 0 1 1 0 256zm320 96c0-26.9-16.5-49.9-40-59.3V88c0-13.3-10.7-24-24-24s-24 10.7-24 24V292.7c-23.5 9.5-40 32.5-40 59.3c0 35.3 28.7 64 64 64s64-28.7 64-64zM144 176a32 32 0 1 0 0-64 32 32 0 1 0 0 64zm-16 80a32 32 0 1 0 -64 0 32 32 0 1 0 64 0zm288 32a32 32 0 1 0 0-64 32 32 0 1 0 0 64zM400 144a32 32 0 1 0 -64 0 32 32 0 1 0 64 0z"/></svg><span class="font-bold">Uptime</span></h1>
                                    </th>
                                    <td class="px-6 py-4">
                                        {{ uptime }}
                                    </td>
                                </tr>
                                <tr class="bg-white dark:bg-gray-700 border-b dark:border-gray-800">
                                    <th scope="row" class="px-6 py-4 font-medium text-gray-900 whitespace-nowrap dark:text-white">
                                        <h1 class="flex items-center"><svg class="mr-2 fill-gray-700 dark:fill-white" xmlns="http://www.w3.org/2000/svg" height="16" width="20" viewBox="0 0 448 512"><path d="M80 104a24 24 0 1 0 0-48 24 24 0 1 0 0 48zm80-24c0 32.8-19.7 61-48 73.3v87.8c18.8-10.9 40.7-17.1 64-17.1h96c35.3 0 64-28.7 64-64v-6.7C307.7 141 288 112.8 288 80c0-44.2 35.8-80 80-80s80 35.8 80 80c0 32.8-19.7 61-48 73.3V160c0 70.7-57.3 128-128 128H176c-35.3 0-64 28.7-64 64v6.7c28.3 12.3 48 40.5 48 73.3c0 44.2-35.8 80-80 80s-80-35.8-80-80c0-32.8 19.7-61 48-73.3V352 153.3C19.7 141 0 112.8 0 80C0 35.8 35.8 0 80 0s80 35.8 80 80zm232 0a24 24 0 1 0 -48 0 24 24 0 1 0 48 0zM80 456a24 24 0 1 0 0-48 24 24 0 1 0 0 48z"/></svg><span class="font-bold">Version</span></h1>
                                    </th>
                                    <td class="px-6 py-4">
                                        {{ version }}
                                    </td>
                                </tr>
                                <tr class="bg-white dark:bg-gray-700 border-b dark:border-gray-800">
                                    <th scope="row" class="px-6 py-4 font-medium text-gray-900 whitespace-nowrap dark:text-white">
                                        <h1 class="flex items-center"><svg class="mr-2 fill-gray-700 dark:fill-white" xmlns="http://www.w3.org/2000/svg" height="16" width="20" viewBox="0 0 512 512"><path d="M336 352c97.2 0 176-78.8 176-176S433.2 0 336 0S160 78.8 160 176c0 18.7 2.9 36.8 8.3 53.7L7 391c-4.5 4.5-7 10.6-7 17v80c0 13.3 10.7 24 24 24h80c13.3 0 24-10.7 24-24V448h40c13.3 0 24-10.7 24-24V384h40c6.4 0 12.5-2.5 17-7l33.3-33.3c16.9 5.4 35 8.3 53.7 8.3zM376 96a40 40 0 1 1 0 80 40 40 0 1 1 0-80z"/></svg><span class="font-bold">Licence</span></h1>
                                    </th>
                                    <td class="px-6 py-4">
                                        {% if licence == "1" %}
                                        <span class="text-green-600 font-bold">Activated</span>
                                        {% else %}
                                        <span class="text-red-600 font-bold">Not activated</span>
                                        {% endif %}
                                    </td>
                                </tr>
                            </tbody>
                        </table>
                    </div>
                </div>
                <div class="col-start-1 row-start-2 bg-white dark:bg-gray-700 rounded-2xl shadow-md p-4">
                    <h1 class="text-xs xl:text-base text-gray-500 font-semibold dark:text-gray-300 mb-2">Scans and Viruses per day</h1>
                    <div id="ScansViruses-chart" class="h-64"></div>
                </div>
                <div class="col-start-2 row-start-1 row-span-2 bg-white dark:bg-gray-700 rounded-2xl shadow-md p-4 flex flex-col">
                    <h1 class="text-xs xl:text-base text-gray-500 font-semibold dark:text-gray-300 mb-2">List of Endpoints</h1>
                    <div class="overflow-y-scroll h-128 max-h-128 rounded-lg">
                        <table class="w-full text-sm text-left rtl:text-right text-gray-500 dark:text-gray-400" id="tableEndpointsForm">
                            <thead class="text-gray-700 bg-white border-b dark:border-gray-800 dark:bg-gray-700 dark:text-white">
                                <tr>
                                    <th scope="col" class="px-6 py-3">
                                        Name
                                    </th>
                                    <th scope="col" class="px-6 py-3">
                                        Status
                                    </th>
                                </tr>
                            </thead>
                            <tbody id="table_endpoint">
                                {% if list_devices|length != 0 %}
                                {% for device in list_devices %}
                                <tr class="bg-white border-b dark:bg-gray-700 dark:border-gray-800 hover:bg-gray-50 dark:hover:bg-gray-600">
                                    <td class="px-6 py-4">
                                        {{ device.hostname }}
                                    </td>
                                    <td class="px-6 py-4">
                                        <div class="flex items-center">
                                            {% if device.state == 1 %}
                                            <div id="state_icon" class="h-2.5 w-2.5 rounded-full bg-green-500 mr-2"></div><span id="state_text">Up</span>
                                            {% else %}
                                            <div id="state_icon" class=" h-2.5 w-2.5 rounded-full bg-red-500 mr-2"></div><div class="animate-ping absolute h-2.5 w-2.5 rounded-full bg-red-500 mr-2"></div><span id="state_text">Down</span>
                                            {% endif %}
                                        </div>
                                    </td>
                                </tr>
                                {% endfor %}
                                {% endif %}
                            </tbody>
                        </table>
                        {% if list_devices|length == 0 %}
                        <div id="" class="flex justify-center p-4 items-center bg-gray-50 dark:bg-gray-600 rounded-b-lg">
                            <h1 class="dark:text-white font-semibold">No endpoint found !</h1>
                        </div>
                        {% else %}
                        <div id="noEndpointFound" style="display: none;" class="flex justify-center p-4 items-center bg-gray-50 dark:bg-gray-600 rounded-b-lg">
                            <h1 class="dark:text-white font-semibold">No endpoint found !</h1>
                        </div>
                        {% endif %}  
                    </div>
                    <div class="mt-auto">
                        <button class="transition ease-in-out delay-75 hover:scale-110 duration-300">
                            <a href="{{ url_for('panel.endpoints.index') }}" class="flex items-center space-x-2 text-gray-400 hover:text-gray-900">
                                <h1 class="text-sm">See more</h1><i class="text-xs fa-solid fa-arrow-right"></i>
                            </a>
                        </button>
                    </div>
                </div>
            </div>
        </div>
     </div>
{% endblock %}
{% block scripts %}
<script type="text/javascript">
    var scan_7day = {{ _7day_virus_scan | tojson}};
</script>
<script src="{{ url_for('static',filename='js/scripts/dashboard.js') }}"></script>
{% endblock %}